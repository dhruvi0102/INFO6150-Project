{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\dhruv\\\\OneDrive\\\\Documents\\\\GitHub\\\\INFO6150-Project\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import _objectSpread from\"C:\\\\Users\\\\dhruv\\\\OneDrive\\\\Documents\\\\GitHub\\\\INFO6150-Project\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import React,{useEffect,useState,useCallback,useReducer,useRef}from\"react\";import{useParams}from\"react-router-dom\";import gsap from\"gsap\";import axios from\"../../axios\";import{ToastContainer,toast}from'react-toastify';import'react-toastify/dist/ReactToastify.css';import PreLoader from\"../../shared/components/PreLoader/PreLoader\";import OrdersList from\"../components/OrdersList\";import Layout from\"../../shared/components/Layout/Layout\";var orderReducer=function orderReducer(state,action){switch(action.type){case\"GET\":return action.orders;case\"DELETE\":return state.filter(function(order){return order.id!==action.id;});case\"UPDATE_ORDER\":return state.map(function(order){if(order.id===action.id){return _objectSpread(_objectSpread({},order),action.update);}return order;});default:return state;}};var Orders=function Orders(){var _useReducer=useReducer(orderReducer,[]),_useReducer2=_slicedToArray(_useReducer,2),orders=_useReducer2[0],dispatch=_useReducer2[1];var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var uid=useParams().id;var tl=useRef();var title=useRef(null);var line=useRef(null);useEffect(function(){tl.current=gsap.timeline();tl.current.from(title,1.5,{scale:0.5,opacity:0}).from(line,2,{width:0},0.5);},[]);useEffect(function(){setIsLoading(true);axios.get(\"/orders/user/\".concat(uid)).then(function(res){console.log(res.data.orders);setIsLoading(false);dispatch({type:\"GET\",orders:res.data.orders});}).catch(function(err){setIsLoading(false);console.log(err);});},[uid]);var onDeleteOrder=useCallback(function(orderId){setIsLoading(true);axios.delete(\"/orders/\".concat(orderId)).then(function(res){setIsLoading(false);dispatch({type:\"DELETE\",id:orderId});}).catch(function(err){toast.error(\"Error Occured! Please Try Again\");setIsLoading(false);console.log(err);});},[]);var onPayNowHandler=useCallback(function(orderId){setIsLoading(true);axios.patch(\"/orders/option/\".concat(orderId),{isPayNow:true},{\"Content-Type\":\"application/json\"}).then(function(res){setIsLoading(false);dispatch({type:\"UPDATE_ORDER\",id:orderId,update:res.data.order});}).catch(function(err){setIsLoading(false);console.log(err);});},[]);var onPayLaterHandler=useCallback(function(orderId){setIsLoading(true);axios.patch(\"/orders/option/\".concat(orderId),{isPayNow:false},{\"Content-Type\":\"application/json\"}).then(function(res){setIsLoading(false);dispatch({type:\"UPDATE_ORDER\",id:orderId,update:res.data.order});}).catch(function(err){setIsLoading(false);console.log(err);});},[]);//Send e-mail on confirm order\nvar sendInvoiceEmail=useCallback(function(orderId){axios.post(\"/emails/send/\".concat(uid),{orderId:orderId},{\"Content-Type\":\"application/json\"}).then(function(res){}).catch(function(err){console.log(err);});},[uid]);var onInvoicePdf=useCallback(function(orderId){setIsLoading(true);axios.get(\"/orders/invoice/\".concat(orderId)).then(function(res){setIsLoading(false);}).catch(function(err){setIsLoading(false);console.log(err);});},[]);return/*#__PURE__*/React.createElement(Layout,null,/*#__PURE__*/React.createElement(\"h1\",{ref:function ref(el){return title=el;},className:\"home-title\"},\"Your order and Checkout page\"),/*#__PURE__*/React.createElement(\"p\",{ref:function ref(el){return line=el;},className:\"line\"}),isLoading?/*#__PURE__*/React.createElement(PreLoader,null):/*#__PURE__*/React.createElement(OrdersList,{orders:orders,onDeleteOrder:onDeleteOrder,onPayNowHandler:onPayNowHandler,onPayLaterHandler:onPayLaterHandler,sendInvoiceEmail:sendInvoiceEmail,onInvoicePdf:onInvoicePdf}),/*#__PURE__*/React.createElement(ToastContainer,null));};export default Orders;","map":{"version":3,"names":["React","useEffect","useState","useCallback","useReducer","useRef","useParams","gsap","axios","ToastContainer","toast","PreLoader","OrdersList","Layout","orderReducer","state","action","type","orders","filter","order","id","map","update","Orders","dispatch","isLoading","setIsLoading","uid","tl","title","line","current","timeline","from","scale","opacity","width","get","then","res","console","log","data","catch","err","onDeleteOrder","orderId","delete","error","onPayNowHandler","patch","isPayNow","onPayLaterHandler","sendInvoiceEmail","post","onInvoicePdf","el"],"sources":["C:/Users/dhruv/OneDrive/Documents/GitHub/INFO6150-Project/Client/src/Orders/pages/OrdersPage.jsx"],"sourcesContent":["import React, {\n  useEffect,\n  useState,\n  useCallback,\n  useReducer,\n  useRef,\n} from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport gsap from \"gsap\";\nimport axios from \"../../axios\";\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport PreLoader from \"../../shared/components/PreLoader/PreLoader\";\nimport OrdersList from \"../components/OrdersList\";\nimport Layout from \"../../shared/components/Layout/Layout\";\n\nconst orderReducer = (state, action) => {\n  switch (action.type) {\n    case \"GET\":\n      return action.orders;\n    case \"DELETE\":\n      return state.filter((order) => order.id !== action.id);\n    case \"UPDATE_ORDER\":\n      return state.map((order) => {\n        if (order.id === action.id) {\n          return {\n            ...order,\n            ...action.update,\n          };\n        }\n        return order;\n      });\n    default:\n      return state;\n  }\n};\n\nconst Orders = () => {\n  const [orders, dispatch] = useReducer(orderReducer, []);\n  const [isLoading, setIsLoading] = useState(false);\n  const uid = useParams().id;\n  let tl = useRef();\n  let title = useRef(null);\n  let line = useRef(null);\n\n  useEffect(() => {\n    tl.current = gsap.timeline();\n    tl.current\n      .from(title, 1.5, { scale: 0.5, opacity: 0 })\n      .from(line, 2, { width: 0 }, 0.5);\n  }, []);\n\n  useEffect(() => {\n    setIsLoading(true);\n    axios\n      .get(`/orders/user/${uid}`)\n      .then((res) => {\n        console.log(res.data.orders);\n        setIsLoading(false);\n        dispatch({ type: \"GET\", orders: res.data.orders });\n      })\n      .catch((err) => {\n        setIsLoading(false);\n        console.log(err);\n      });\n  }, [uid]);\n\n  const onDeleteOrder = useCallback((orderId) => {\n    setIsLoading(true);\n    axios\n      .delete(`/orders/${orderId}`)\n      .then((res) => {\n        setIsLoading(false);\n        dispatch({ type: \"DELETE\", id: orderId });\n      })\n      .catch((err) => {\n        toast.error(\"Error Occured! Please Try Again\")\n        setIsLoading(false);\n        console.log(err);\n      });\n  }, []);\n\n  const onPayNowHandler = useCallback((orderId) => {\n    setIsLoading(true);\n    axios\n      .patch(\n        `/orders/option/${orderId}`,\n        { isPayNow: true },\n        { \"Content-Type\": \"application/json\" }\n      )\n      .then((res) => {\n        setIsLoading(false);\n        dispatch({ type: \"UPDATE_ORDER\", id: orderId, update: res.data.order });\n      })\n      .catch((err) => {\n        setIsLoading(false);\n        console.log(err);\n      });\n  }, []);\n\n  const onPayLaterHandler = useCallback((orderId) => {\n    setIsLoading(true);\n    axios\n      .patch(\n        `/orders/option/${orderId}`,\n        { isPayNow: false },\n        { \"Content-Type\": \"application/json\" }\n      )\n      .then((res) => {\n        setIsLoading(false);\n        dispatch({ type: \"UPDATE_ORDER\", id: orderId, update: res.data.order });\n      })\n      .catch((err) => {\n        setIsLoading(false);\n        console.log(err);\n      });\n  }, []);\n\n  //Send e-mail on confirm order\n  const sendInvoiceEmail = useCallback(\n    (orderId) => {\n      axios\n        .post(\n          `/emails/send/${uid}`,\n          { orderId },\n          { \"Content-Type\": \"application/json\" }\n        )\n        .then((res) => {})\n        .catch((err) => {\n          console.log(err);\n        });\n    },\n    [uid]\n  );\n\n  const onInvoicePdf = useCallback((orderId) => {\n    setIsLoading(true);\n    axios\n      .get(`/orders/invoice/${orderId}`)\n      .then((res) => {\n        setIsLoading(false);\n      })\n      .catch((err) => {\n        setIsLoading(false);\n        console.log(err);\n      });\n  }, []);\n\n  return (\n    <Layout>\n      <h1 ref={(el) => (title = el)} className=\"home-title\">\n        Your order and Checkout page\n      </h1>\n      <p ref={(el) => (line = el)} className=\"line\" />\n      {isLoading ? (\n        <PreLoader />\n      ) : (\n        <OrdersList\n          orders={orders}\n          onDeleteOrder={onDeleteOrder}\n          onPayNowHandler={onPayNowHandler}\n          onPayLaterHandler={onPayLaterHandler}\n          sendInvoiceEmail={sendInvoiceEmail}\n          onInvoicePdf={onInvoicePdf}\n        />\n      )}\n      <ToastContainer />\n    </Layout>\n  );\n};\n\nexport default Orders;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\dhruv\\\\OneDrive\\\\Documents\\\\GitHub\\\\INFO6150-Project\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState,useRef,useCallback,Fragment,useReducer,useContext}from'react';import axios from'../../axios';import gsap from'gsap';import{ThemeContext,themes}from'../../shared/contexts/ThemeContext';import FleetList from'../components/FleetList';import Layout from'../../shared/components/Layout/Layout';import PreLoader from'../../shared/components/PreLoader/PreLoader';import SearchForm from'../components/SearchForm';import Pagination from'../../shared/components/Pagination/Pagination';import SortButtons from'../components/SortButtons';var fleetReducer=function fleetReducer(state,action){switch(action.type){case'GET':return action.fleet;case'HIGH_FIRST':return state.slice().sort(function(a,b){return b.price-a.price;});case'LOW_FIRST':return state.slice().sort(function(a,b){return a.price-b.price;});default:return state;}};var FleetPage=function FleetPage(){var _useReducer=useReducer(fleetReducer,[]),_useReducer2=_slicedToArray(_useReducer,2),fleet=_useReducer2[0],dispatch=_useReducer2[1];var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),search=_useState4[0],setSearch=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),onSearch=_useState6[0],setOnSearch=_useState6[1];var _useState7=useState(1),_useState8=_slicedToArray(_useState7,2),currentPage=_useState8[0],setCurrenPage=_useState8[1];var itemsPerPage=6;var tl=useRef();var title=useRef(null);var line=useRef(null);var subtitle=useRef(null);var indexOfLastItem=currentPage*itemsPerPage;var indexOfFirstItem=indexOfLastItem-itemsPerPage;var currentItems=fleet.slice(indexOfFirstItem,indexOfLastItem);useEffect(function(){tl.current=gsap.timeline();tl.current.from(title,1,{x:-200,opacity:0}).from(subtitle,1,{x:100,opacity:0},0.5).from(line,2,{width:0},0.5);},[]);//Fetch all rentals from db\nuseEffect(function(){setIsLoading(true);axios.get('/fleet').then(function(res){setIsLoading(false);dispatch({type:'GET',fleet:res.data.rental});}).catch(function(err){setIsLoading(false);console.log(err);});},[]);//Search for different results \nvar onSubmitNameHandler=useCallback(function(name){setIsLoading(true);axios.get(\"/fleet/sort/\".concat(name)).then(function(res){setIsLoading(false);setSearch(res.data.rental);setOnSearch(true);}).catch(function(err){setIsLoading(false);console.log(err);});},[]);var onSearchClear=useCallback(function(){setOnSearch(false);},[]);var onPaginationHandler=function onPaginationHandler(number){setCurrenPage(number);};var onHighPrice=function onHighPrice(){dispatch({type:'HIGH_FIRST'});};var onLowPrice=function onLowPrice(){dispatch({type:'LOW_FIRST'});};var mainList=/*#__PURE__*/React.createElement(Fragment,null,isLoading?/*#__PURE__*/React.createElement(PreLoader,null):/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(SortButtons,{onHighPrice:onHighPrice,onLowPrice:onLowPrice}),/*#__PURE__*/React.createElement(FleetList,{fleet:currentItems}),fleet.length>6&&/*#__PURE__*/React.createElement(Pagination,{totalItems:fleet.length,itemsPerPage:itemsPerPage,pagination:onPaginationHandler})));var searchList=/*#__PURE__*/React.createElement(Fragment,null,isLoading?/*#__PURE__*/React.createElement(PreLoader,null):/*#__PURE__*/React.createElement(FleetList,{fleet:search}));var mainRentalList;if(fleet.length){mainRentalList=/*#__PURE__*/React.createElement(\"p\",{className:\"offer-counter\"},\"we have \",fleet.length,\" total\",/*#__PURE__*/React.createElement(\"span\",null,\" \",fleet.length===1?'offer':'offers',\" \"),\"for you\");}var searched;if(search.length){searched=/*#__PURE__*/React.createElement(\"p\",{className:\"offer-counter\"},\"we have \",search.length,\" total\",/*#__PURE__*/React.createElement(\"span\",null,\" \",search.length===1?'offer':'offers',\" \"),\"for you\");}else{searched=/*#__PURE__*/React.createElement(\"p\",{className:\"offer-counter\"},\"we dont have any offers for you\");}var _useContext=useContext(ThemeContext),currentTheme=_useContext.currentTheme,toggleTheme=_useContext.toggleTheme;console.log(currentTheme);return/*#__PURE__*/React.createElement(Layout,null,/*#__PURE__*/React.createElement(SearchForm,{onSubmitNameHandler:onSubmitNameHandler,onSearch:onSearch,onSearchClear:onSearchClear}),/*#__PURE__*/React.createElement(\"h1\",{ref:function ref(el){return title=el;},className:\"home-title\"},\"Premium rentals\"),/*#__PURE__*/React.createElement(\"p\",{ref:function ref(el){return subtitle=el;},className:\"subtitle\"},\"check our fleet\"),/*#__PURE__*/React.createElement(\"p\",{ref:function ref(el){return line=el;},className:\"line\",style:{backgroundColor:currentTheme.cardBorderBottomColor}}),onSearch?searched:mainRentalList,onSearch?searchList:mainList);};export default FleetPage;","map":{"version":3,"names":["React","useEffect","useState","useRef","useCallback","Fragment","useReducer","useContext","axios","gsap","ThemeContext","themes","FleetList","Layout","PreLoader","SearchForm","Pagination","SortButtons","fleetReducer","state","action","type","fleet","slice","sort","a","b","price","FleetPage","dispatch","isLoading","setIsLoading","search","setSearch","onSearch","setOnSearch","currentPage","setCurrenPage","itemsPerPage","tl","title","line","subtitle","indexOfLastItem","indexOfFirstItem","currentItems","current","timeline","from","x","opacity","width","get","then","res","data","rental","catch","err","console","log","onSubmitNameHandler","name","onSearchClear","onPaginationHandler","number","onHighPrice","onLowPrice","mainList","length","searchList","mainRentalList","searched","currentTheme","toggleTheme","el","backgroundColor","cardBorderBottomColor"],"sources":["C:/Users/dhruv/OneDrive/Documents/GitHub/INFO6150-Project/Client/src/Fleet/pages/FleetPage.jsx"],"sourcesContent":["import React, { useEffect, useState, useRef, useCallback, Fragment, useReducer , useContext} from 'react';\nimport axios from '../../axios';\nimport gsap from 'gsap';\nimport { ThemeContext, themes} from '../../shared/contexts/ThemeContext';\n\nimport FleetList from '../components/FleetList';\nimport Layout from '../../shared/components/Layout/Layout';\nimport PreLoader from '../../shared/components/PreLoader/PreLoader';\nimport SearchForm from '../components/SearchForm';\nimport Pagination from '../../shared/components/Pagination/Pagination';\nimport SortButtons from '../components/SortButtons';\n\nconst fleetReducer = ( state, action ) => {\n    switch(action.type){\n        case 'GET':\n            return action.fleet;\n        case 'HIGH_FIRST':\n            return state.slice().sort((a, b) => b.price - a.price)\n        case 'LOW_FIRST':\n            return state.slice().sort((a, b) => a.price - b.price)\n        default:\n            return state;\n    }\n};\n\nconst FleetPage = () => {\n  \n    const [ fleet, dispatch ] = useReducer(fleetReducer, []);\n    const [ isLoading, setIsLoading ] = useState(false);\n    const [ search, setSearch ] = useState([]);\n    const [ onSearch, setOnSearch] = useState(false)\n    const [ currentPage, setCurrenPage ] = useState(1);\n    const itemsPerPage = 6;\n    let tl = useRef();\n    let title = useRef(null);\n    let line = useRef(null);\n    let subtitle = useRef(null);\n\n    const indexOfLastItem = currentPage * itemsPerPage;\n    const indexOfFirstItem = indexOfLastItem - itemsPerPage;\n    const currentItems = fleet.slice(indexOfFirstItem, indexOfLastItem);\n\n    useEffect(() => {\n        tl.current = gsap.timeline();\n        tl.current.from(title, 1,{x: -200, opacity:0})\n                  .from(subtitle, 1, {x: 100, opacity: 0}, 0.5)\n                  .from(line, 2, { width: 0 }, 0.5)\n    }, []);\n\n    //Fetch all rentals from db\n    useEffect(() => {\n        setIsLoading(true)\n        axios.get('/fleet')\n             .then(res => {\n                setIsLoading(false);\n                dispatch({type: 'GET', fleet: res.data.rental})\n             }).catch(err => {\n                setIsLoading(false);\n                console.log(err);\n             })\n    }, []);\n\n    //Search for different results \n    const onSubmitNameHandler = useCallback((name) => {\n        setIsLoading(true)\n        \n        axios.get(`/fleet/sort/${name}`)\n             .then(res => {\n               \n                setIsLoading(false);\n                setSearch(res.data.rental);\n                setOnSearch(true);\n             }).catch(err => {\n                setIsLoading(false);\n                console.log(err)\n             });\n    }, []);\n\n    const onSearchClear = useCallback(() => {\n        setOnSearch(false)\n    }, []);\n\n    const onPaginationHandler = (number) => {\n        setCurrenPage(number);      \n    };\n\n    const onHighPrice = () => {\n        dispatch({type: 'HIGH_FIRST'});\n    }\n    const onLowPrice = () => {\n        dispatch({type: 'LOW_FIRST'});\n    }\n   \n    let mainList = <Fragment>\n                    {\n                        isLoading \n                        ? <PreLoader /> \n                        : <Fragment>  \n                            <SortButtons onHighPrice={onHighPrice}\n                                         onLowPrice={onLowPrice}/>                        \n                            <FleetList fleet={currentItems} />\n                            { \n                                fleet.length > 6 && \n                                <Pagination totalItems={fleet.length}\n                                itemsPerPage={itemsPerPage}\n                                pagination={onPaginationHandler}/>\n                            }\n                          </Fragment>\n\n                    }    \n                    </Fragment>\n\n    let searchList = <Fragment>\n                    {\n                        isLoading \n                        ? <PreLoader /> \n                        : <FleetList fleet={search} />\n                    }    \n                    </Fragment> \n\n    let mainRentalList;\n    if(fleet.length){\n        mainRentalList = <p className='offer-counter'>we have {fleet.length} total\n        <span> {fleet.length ===  1 ? 'offer' : 'offers'} </span>for you</p>\n    }\n\n    let searched\n    if(search.length){\n        searched = <p className='offer-counter'>we have {search.length} total\n        <span> {search.length ===  1 ? 'offer' : 'offers'} </span>for you</p>\n    }else{\n        searched = <p className='offer-counter'>we dont have any offers for you</p>\n    }              \n    const { currentTheme, toggleTheme } = useContext(ThemeContext);\nconsole.log(currentTheme);\n    return(\n\n\n        <Layout>  \n            <SearchForm onSubmitNameHandler={onSubmitNameHandler}\n            onSearch={onSearch}\n            onSearchClear={onSearchClear}/>\n            <h1 ref={ el => ( title = el )} className='home-title'>Premium rentals</h1>\n            <p ref={ el => ( subtitle = el )} className='subtitle'>check our fleet</p>\n            <p ref={ el => ( line = el )} className='line'  style={{backgroundColor:currentTheme.cardBorderBottomColor}}/>\n            { onSearch ? searched : mainRentalList }       \n            { onSearch ? searchList : mainList }      \n        </Layout>\n    )\n}\n\nexport default FleetPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}
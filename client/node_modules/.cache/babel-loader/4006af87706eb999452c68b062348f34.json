{"ast":null,"code":"var _jsxFileName = \"D:\\\\Northeastern\\\\Semester 3\\\\Web design\\\\web-project-master\\\\web-project-master\\\\client\\\\src\\\\shared\\\\contexts\\\\AuthContext.jsx\";\nimport React, { createContext, useState, useCallback, useEffect } from 'react';\n\n//Authentication context \nexport const AuthContext = createContext({\n  isLoggedIn: false,\n  userId: null,\n  token: null,\n  name: null\n});\nlet logoutTimer;\nconst AuthContextProvider = props => {\n  const [token, setToken] = useState(false);\n  const [userId, setUserId] = useState(false);\n  const [name, setName] = useState(false);\n  const [expirTime, setExpTimer] = useState();\n  const login = useCallback((uid, token, name, expirInTime) => {\n    setToken(token);\n    setUserId(uid);\n    setName(name);\n    const tokenExpirationTime = expirInTime || new Date(new Date().getTime() + 1000 * 60 * 60);\n    setExpTimer(tokenExpirationTime);\n    localStorage.setItem('userData', JSON.stringify({\n      userId: uid,\n      token: token,\n      name: name,\n      expiration: tokenExpirationTime.toISOString()\n    }));\n  }, []);\n  const logout = useCallback(() => {\n    setToken(null);\n    setUserId(null);\n    setName(null);\n    setExpTimer(null);\n    localStorage.removeItem('userData');\n  }, []);\n  useEffect(() => {\n    const storedData = JSON.parse(localStorage.getItem('userData'));\n    if (storedData && storedData.token && new Date(storedData.expiration) > new Date()) {\n      login(storedData.userId, storedData.token, storedData.name, new Date(storedData.expiration));\n    }\n  }, [login]);\n  useEffect(() => {\n    if (token && expirTime) {\n      const remainingTime = expirTime.getTime() - new Date().getTime();\n      logoutTimer = setTimeout(logout, remainingTime);\n    } else {\n      clearTimeout(logoutTimer);\n    }\n  }, [token, logout, expirTime]);\n  return /*#__PURE__*/React.createElement(AuthContext.Provider, {\n    value: {\n      isLoggedIn: !!token,\n      token: token,\n      userId: userId,\n      name: name,\n      login,\n      logout\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 9\n    }\n  }, props.children);\n};\nexport default AuthContextProvider;","map":{"version":3,"names":["React","createContext","useState","useCallback","useEffect","AuthContext","isLoggedIn","userId","token","name","logoutTimer","AuthContextProvider","props","setToken","setUserId","setName","expirTime","setExpTimer","login","uid","expirInTime","tokenExpirationTime","Date","getTime","localStorage","setItem","JSON","stringify","expiration","toISOString","logout","removeItem","storedData","parse","getItem","remainingTime","setTimeout","clearTimeout","children"],"sources":["D:/Northeastern/Semester 3/Web design/web-project-master/web-project-master/client/src/shared/contexts/AuthContext.jsx"],"sourcesContent":["import React, { createContext, useState, useCallback, useEffect } from 'react';\n\n//Authentication context \nexport const AuthContext = createContext({\n    isLoggedIn: false,\n    userId: null,\n    token: null,\n    name: null,\n});\n\nlet logoutTimer;\n\nconst AuthContextProvider = (props) => {\n\n    const [token, setToken] = useState(false);\n    const [userId, setUserId] = useState(false);\n    const [name, setName] = useState(false)\n    const [expirTime, setExpTimer] = useState();\n\n    const login = useCallback((uid, token, name, expirInTime ) => {\n        setToken(token);\n        setUserId(uid);\n        setName(name)\n        const tokenExpirationTime =\n        expirInTime || new Date(new Date().getTime() + 1000 * 60 * 60);\n          setExpTimer(tokenExpirationTime);\n    \n        localStorage.setItem\n        ('userData', \n        JSON.stringify(\n          {userId: uid,\n           token: token,\n           name: name, \n           expiration: tokenExpirationTime.toISOString() }));\n      }, []);\n\n      const logout = useCallback(() => {\n        setToken(null);\n        setUserId(null);\n        setName(null);\n        setExpTimer(null);\n        localStorage.removeItem('userData');\n      }, []);\n\n      useEffect(() => {\n        const storedData = JSON.parse(localStorage.getItem('userData'));\n        if (storedData && storedData.token && new Date(storedData.expiration) > new Date() ) {\n          login(storedData.userId, storedData.token, storedData.name, new Date(storedData.expiration));\n        }\n      }, [login]);\n    \n      useEffect(() => {\n        if(token && expirTime){\n          const remainingTime = expirTime.getTime() - new Date().getTime();\n          logoutTimer = setTimeout(logout, remainingTime);\n        }else {\n          clearTimeout(logoutTimer);\n        }\n      }, [token, logout, expirTime]);\n\n    return(\n        <AuthContext.Provider value={{\n            isLoggedIn: !!token,\n            token: token,\n            userId: userId,\n            name: name,\n            login,\n            logout\n        }}>\n            {props.children}\n        </AuthContext.Provider>\n    )\n}\n\nexport default AuthContextProvider;"],"mappings":"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"},"metadata":{},"sourceType":"module"}
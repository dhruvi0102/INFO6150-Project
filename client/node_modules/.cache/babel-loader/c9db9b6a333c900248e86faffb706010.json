{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\dhruv\\\\OneDrive\\\\Documents\\\\GitHub\\\\INFO6150-Project\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{createContext,useState,useCallback,useEffect}from'react';//Authentication context \nexport var AuthContext=createContext({isLoggedIn:false,userId:null,token:null,name:null});var logoutTimer;var AuthContextProvider=function AuthContextProvider(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),token=_useState2[0],setToken=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),userId=_useState4[0],setUserId=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),name=_useState6[0],setName=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),expirTime=_useState8[0],setExpTimer=_useState8[1];var login=useCallback(function(uid,token,name,expirInTime){setToken(token);setUserId(uid);setName(name);var tokenExpirationTime=expirInTime||new Date(new Date().getTime()+1000*60*60);setExpTimer(tokenExpirationTime);localStorage.setItem('userData',JSON.stringify({userId:uid,token:token,name:name,expiration:tokenExpirationTime.toISOString()}));},[]);var logout=useCallback(function(){setToken(null);setUserId(null);setName(null);setExpTimer(null);localStorage.removeItem('userData');},[]);useEffect(function(){var storedData=JSON.parse(localStorage.getItem('userData'));if(storedData&&storedData.token&&new Date(storedData.expiration)>new Date()){login(storedData.userId,storedData.token,storedData.name,new Date(storedData.expiration));}},[login]);useEffect(function(){if(token&&expirTime){var remainingTime=expirTime.getTime()-new Date().getTime();logoutTimer=setTimeout(logout,remainingTime);}else{clearTimeout(logoutTimer);}},[token,logout,expirTime]);return/*#__PURE__*/React.createElement(AuthContext.Provider,{value:{isLoggedIn:!!token,token:token,userId:userId,name:name,login:login,logout:logout}},props.children);};export default AuthContextProvider;","map":{"version":3,"names":["React","createContext","useState","useCallback","useEffect","AuthContext","isLoggedIn","userId","token","name","logoutTimer","AuthContextProvider","props","setToken","setUserId","setName","expirTime","setExpTimer","login","uid","expirInTime","tokenExpirationTime","Date","getTime","localStorage","setItem","JSON","stringify","expiration","toISOString","logout","removeItem","storedData","parse","getItem","remainingTime","setTimeout","clearTimeout","children"],"sources":["C:/Users/dhruv/OneDrive/Documents/GitHub/INFO6150-Project/Client/src/shared/contexts/AuthContext.jsx"],"sourcesContent":["import React, { createContext, useState, useCallback, useEffect } from 'react';\n\n//Authentication context \nexport const AuthContext = createContext({\n    isLoggedIn: false,\n    userId: null,\n    token: null,\n    name: null,\n});\n\nlet logoutTimer;\n\nconst AuthContextProvider = (props) => {\n\n    const [token, setToken] = useState(false);\n    const [userId, setUserId] = useState(false);\n    const [name, setName] = useState(false)\n    const [expirTime, setExpTimer] = useState();\n\n    const login = useCallback((uid, token, name, expirInTime ) => {\n        setToken(token);\n        setUserId(uid);\n        setName(name)\n        const tokenExpirationTime =\n        expirInTime || new Date(new Date().getTime() + 1000 * 60 * 60);\n          setExpTimer(tokenExpirationTime);\n    \n        localStorage.setItem\n        ('userData', \n        JSON.stringify(\n          {userId: uid,\n           token: token,\n           name: name, \n           expiration: tokenExpirationTime.toISOString() }));\n      }, []);\n\n      const logout = useCallback(() => {\n        setToken(null);\n        setUserId(null);\n        setName(null);\n        setExpTimer(null);\n        localStorage.removeItem('userData');\n      }, []);\n\n      useEffect(() => {\n        const storedData = JSON.parse(localStorage.getItem('userData'));\n        if (storedData && storedData.token && new Date(storedData.expiration) > new Date() ) {\n          login(storedData.userId, storedData.token, storedData.name, new Date(storedData.expiration));\n        }\n      }, [login]);\n    \n      useEffect(() => {\n        if(token && expirTime){\n          const remainingTime = expirTime.getTime() - new Date().getTime();\n          logoutTimer = setTimeout(logout, remainingTime);\n        }else {\n          clearTimeout(logoutTimer);\n        }\n      }, [token, logout, expirTime]);\n\n    return(\n        <AuthContext.Provider value={{\n            isLoggedIn: !!token,\n            token: token,\n            userId: userId,\n            name: name,\n            login,\n            logout\n        }}>\n            {props.children}\n        </AuthContext.Provider>\n    )\n}\n\nexport default AuthContextProvider;"],"mappings":"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"},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"var _jsxFileName = \"D:\\\\Northeastern\\\\Semester 3\\\\Web design\\\\web-project-master\\\\web-project-master\\\\client\\\\src\\\\Orders\\\\pages\\\\OrdersPage.jsx\";\nimport React, { useEffect, useState, useCallback, useReducer, useRef } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport gsap from \"gsap\";\nimport axios from \"../../axios\";\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport PreLoader from \"../../shared/components/PreLoader/PreLoader\";\nimport OrdersList from \"../components/OrdersList\";\nimport Layout from \"../../shared/components/Layout/Layout\";\nconst orderReducer = (state, action) => {\n  switch (action.type) {\n    case \"GET\":\n      return action.orders;\n    case \"DELETE\":\n      return state.filter(order => order.id !== action.id);\n    case \"UPDATE_ORDER\":\n      return state.map(order => {\n        if (order.id === action.id) {\n          return {\n            ...order,\n            ...action.update\n          };\n        }\n        return order;\n      });\n    default:\n      return state;\n  }\n};\nconst Orders = () => {\n  const [orders, dispatch] = useReducer(orderReducer, []);\n  const [isLoading, setIsLoading] = useState(false);\n  const uid = useParams().id;\n  let tl = useRef();\n  let title = useRef(null);\n  let line = useRef(null);\n  useEffect(() => {\n    tl.current = gsap.timeline();\n    tl.current.from(title, 1.5, {\n      scale: 0.5,\n      opacity: 0\n    }).from(line, 2, {\n      width: 0\n    }, 0.5);\n  }, []);\n  useEffect(() => {\n    setIsLoading(true);\n    axios.get(`/orders/user/${uid}`).then(res => {\n      console.log(res.data.orders);\n      setIsLoading(false);\n      dispatch({\n        type: \"GET\",\n        orders: res.data.orders\n      });\n    }).catch(err => {\n      setIsLoading(false);\n      console.log(err);\n    });\n  }, [uid]);\n  const onDeleteOrder = useCallback(orderId => {\n    setIsLoading(true);\n    axios.delete(`/orders/${orderId}`).then(res => {\n      setIsLoading(false);\n      dispatch({\n        type: \"DELETE\",\n        id: orderId\n      });\n    }).catch(err => {\n      toast.error(\"Error Occured! Please Try Again\");\n      setIsLoading(false);\n      console.log(err);\n    });\n  }, []);\n  const onPayNowHandler = useCallback(orderId => {\n    setIsLoading(true);\n    axios.patch(`/orders/option/${orderId}`, {\n      isPayNow: true\n    }, {\n      \"Content-Type\": \"application/json\"\n    }).then(res => {\n      setIsLoading(false);\n      dispatch({\n        type: \"UPDATE_ORDER\",\n        id: orderId,\n        update: res.data.order\n      });\n    }).catch(err => {\n      setIsLoading(false);\n      console.log(err);\n    });\n  }, []);\n  const onPayLaterHandler = useCallback(orderId => {\n    setIsLoading(true);\n    axios.patch(`/orders/option/${orderId}`, {\n      isPayNow: false\n    }, {\n      \"Content-Type\": \"application/json\"\n    }).then(res => {\n      setIsLoading(false);\n      dispatch({\n        type: \"UPDATE_ORDER\",\n        id: orderId,\n        update: res.data.order\n      });\n    }).catch(err => {\n      setIsLoading(false);\n      console.log(err);\n    });\n  }, []);\n\n  //Send e-mail on confirm order\n  const sendInvoiceEmail = useCallback(orderId => {\n    axios.post(`/emails/send/${uid}`, {\n      orderId\n    }, {\n      \"Content-Type\": \"application/json\"\n    }).then(res => {}).catch(err => {\n      console.log(err);\n    });\n  }, [uid]);\n  const onInvoicePdf = useCallback(orderId => {\n    setIsLoading(true);\n    axios.get(`/orders/invoice/${orderId}`).then(res => {\n      setIsLoading(false);\n    }).catch(err => {\n      setIsLoading(false);\n      console.log(err);\n    });\n  }, []);\n  return /*#__PURE__*/React.createElement(Layout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    ref: el => title = el,\n    className: \"home-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 7\n    }\n  }, \"Your order and Checkout page\"), /*#__PURE__*/React.createElement(\"p\", {\n    ref: el => line = el,\n    className: \"line\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 7\n    }\n  }), isLoading ? /*#__PURE__*/React.createElement(PreLoader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 9\n    }\n  }) : /*#__PURE__*/React.createElement(OrdersList, {\n    orders: orders,\n    onDeleteOrder: onDeleteOrder,\n    onPayNowHandler: onPayNowHandler,\n    onPayLaterHandler: onPayLaterHandler,\n    sendInvoiceEmail: sendInvoiceEmail,\n    onInvoicePdf: onInvoicePdf,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(ToastContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 7\n    }\n  }));\n};\nexport default Orders;","map":{"version":3,"names":["React","useEffect","useState","useCallback","useReducer","useRef","useParams","gsap","axios","ToastContainer","toast","PreLoader","OrdersList","Layout","orderReducer","state","action","type","orders","filter","order","id","map","update","Orders","dispatch","isLoading","setIsLoading","uid","tl","title","line","current","timeline","from","scale","opacity","width","get","then","res","console","log","data","catch","err","onDeleteOrder","orderId","delete","error","onPayNowHandler","patch","isPayNow","onPayLaterHandler","sendInvoiceEmail","post","onInvoicePdf","el"],"sources":["D:/Northeastern/Semester 3/Web design/web-project-master/web-project-master/client/src/Orders/pages/OrdersPage.jsx"],"sourcesContent":["import React, {\n  useEffect,\n  useState,\n  useCallback,\n  useReducer,\n  useRef,\n} from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport gsap from \"gsap\";\nimport axios from \"../../axios\";\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport PreLoader from \"../../shared/components/PreLoader/PreLoader\";\nimport OrdersList from \"../components/OrdersList\";\nimport Layout from \"../../shared/components/Layout/Layout\";\n\nconst orderReducer = (state, action) => {\n  switch (action.type) {\n    case \"GET\":\n      return action.orders;\n    case \"DELETE\":\n      return state.filter((order) => order.id !== action.id);\n    case \"UPDATE_ORDER\":\n      return state.map((order) => {\n        if (order.id === action.id) {\n          return {\n            ...order,\n            ...action.update,\n          };\n        }\n        return order;\n      });\n    default:\n      return state;\n  }\n};\n\nconst Orders = () => {\n  const [orders, dispatch] = useReducer(orderReducer, []);\n  const [isLoading, setIsLoading] = useState(false);\n  const uid = useParams().id;\n  let tl = useRef();\n  let title = useRef(null);\n  let line = useRef(null);\n\n  useEffect(() => {\n    tl.current = gsap.timeline();\n    tl.current\n      .from(title, 1.5, { scale: 0.5, opacity: 0 })\n      .from(line, 2, { width: 0 }, 0.5);\n  }, []);\n\n  useEffect(() => {\n    setIsLoading(true);\n    axios\n      .get(`/orders/user/${uid}`)\n      .then((res) => {\n        console.log(res.data.orders);\n        setIsLoading(false);\n        dispatch({ type: \"GET\", orders: res.data.orders });\n      })\n      .catch((err) => {\n        setIsLoading(false);\n        console.log(err);\n      });\n  }, [uid]);\n\n  const onDeleteOrder = useCallback((orderId) => {\n    setIsLoading(true);\n    axios\n      .delete(`/orders/${orderId}`)\n      .then((res) => {\n        setIsLoading(false);\n        dispatch({ type: \"DELETE\", id: orderId });\n      })\n      .catch((err) => {\n        toast.error(\"Error Occured! Please Try Again\")\n        setIsLoading(false);\n        console.log(err);\n      });\n  }, []);\n\n  const onPayNowHandler = useCallback((orderId) => {\n    setIsLoading(true);\n    axios\n      .patch(\n        `/orders/option/${orderId}`,\n        { isPayNow: true },\n        { \"Content-Type\": \"application/json\" }\n      )\n      .then((res) => {\n        setIsLoading(false);\n        dispatch({ type: \"UPDATE_ORDER\", id: orderId, update: res.data.order });\n      })\n      .catch((err) => {\n        setIsLoading(false);\n        console.log(err);\n      });\n  }, []);\n\n  const onPayLaterHandler = useCallback((orderId) => {\n    setIsLoading(true);\n    axios\n      .patch(\n        `/orders/option/${orderId}`,\n        { isPayNow: false },\n        { \"Content-Type\": \"application/json\" }\n      )\n      .then((res) => {\n        setIsLoading(false);\n        dispatch({ type: \"UPDATE_ORDER\", id: orderId, update: res.data.order });\n      })\n      .catch((err) => {\n        setIsLoading(false);\n        console.log(err);\n      });\n  }, []);\n\n  //Send e-mail on confirm order\n  const sendInvoiceEmail = useCallback(\n    (orderId) => {\n      axios\n        .post(\n          `/emails/send/${uid}`,\n          { orderId },\n          { \"Content-Type\": \"application/json\" }\n        )\n        .then((res) => {})\n        .catch((err) => {\n          console.log(err);\n        });\n    },\n    [uid]\n  );\n\n  const onInvoicePdf = useCallback((orderId) => {\n    setIsLoading(true);\n    axios\n      .get(`/orders/invoice/${orderId}`)\n      .then((res) => {\n        setIsLoading(false);\n      })\n      .catch((err) => {\n        setIsLoading(false);\n        console.log(err);\n      });\n  }, []);\n\n  return (\n    <Layout>\n      <h1 ref={(el) => (title = el)} className=\"home-title\">\n        Your order and Checkout page\n      </h1>\n      <p ref={(el) => (line = el)} className=\"line\" />\n      {isLoading ? (\n        <PreLoader />\n      ) : (\n        <OrdersList\n          orders={orders}\n          onDeleteOrder={onDeleteOrder}\n          onPayNowHandler={onPayNowHandler}\n          onPayLaterHandler={onPayLaterHandler}\n          sendInvoiceEmail={sendInvoiceEmail}\n          onInvoicePdf={onInvoicePdf}\n        />\n      )}\n      <ToastContainer />\n    </Layout>\n  );\n};\n\nexport default Orders;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}